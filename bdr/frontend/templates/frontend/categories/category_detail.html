{% extends "bdr/base.html" %}

{% block title %}{{ category.name }}{% endblock %}

{% block sidebar %}
    <nav>
        <h2>Actions</h2>
        <ul class="nav nav-pills nav-stacked">
            <li class="active" role="presentation"><a href="{{ object.get_absolute_url }}">
                <span class="glyphicon glyphicon-file" aria-hidden="true"></span> View
            </a></li>
            <li role="presentation"><a href="{% url 'bdr.frontend:category-edit' slug=object.slug %}">
                <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span> Edit
            </a></li>
            <li role="presentation"><a href="{% url 'bdr.frontend:category-delete' slug=object.slug %}">
                <span class="glyphicon glyphicon-remove" aria-hidden="true"></span> Delete
            </a></li>
        </ul>
    </nav>
{% endblock %}

{% block content %}
    <header class="page-header">
        <h1>
            {{ category.name }}
        {% if category.parent %}
            <a class="small" href="{{ category.parent.get_absolute_url }}">{{ category.parent.name }}</a>
        {% endif %}
        </h1>
    </header>
    <section>
        <h2>Datasets</h2>
        {% with datasets=category.datasets.all %}
        {% if datasets %}
            <table class="table table-condensed">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Files</th>
                        <td></td>
                    </tr>
                </thead>
            {% for dataset in datasets %}
                <tbody>
                <tr>
                    <th><a href="{{ dataset.get_absolute_url }}">{{ dataset.name }}</a></th>
                    <td>{{ dataset.num_files }}</td>
                    <td class="text-right">
                {% if dataset.tags.all|length > 0 %}
                    {% for tag in dataset.tags.all %}
                        <a class="small label label-default"
                           href="{% url 'bdr.frontend:search' %}?query={{ tag|urlencode }}">{{ tag }}</a>
                    {% endfor %}
                {% endif %}
                    </td>
                </tr>
                </tbody>
            {% endfor %}
            </table>
        {% else %}
            <p>There are no datasets in this category.</p>
        {% endif %}
        {% endwith %}
    </section>
{% endblock %}
